#!/sbin/openrc-run

description="Adjust the fan speed according to the temperature of the hard drive"

cfgfile="/etc/conf.d/$RC_SVCNAME.conf"
pidfile="/run/$RC_SVCNAME.pid"

command=/usr/bin/hddfancontrol
command_args="$(cat $cfgfile | egrep '^\s*HDDFANCONTROL_ARGS' | sed -E -e 's/^\s*HDDFANCONTROL_ARGS\s*=\s*"\s*//' -e 's/["#].*$//')"
command_args_background="--background --pid-file $pidfile"

capabilities="CAP_SYS_RAWIO"

required_files="$cfgfile"

depend() {
        after lm_sensors
}
